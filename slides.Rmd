---
title: "R package development"
subtitle: "from laying functions to package hatching"
author: "Maëlle Salmon (`r icon::fa('twitter')` ma_salmon, `r icon::fa('github')` maelle)"
date: "2018/03/16"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---


```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
```

## Good morning! Goeie môre! Sanibonani! Molweni! Bonjour!

What I do in R...

* (Research) software engineer for rOpenSci & Locke Data.

* R-Ladies, R Weekly.

* Onboarding co-editor at rOpenSci.


---

## Why learning about package development?

Jon Calder's very good wording, thanks Jon!

--

* To share code (and data)

--

* To leverage existing tooling

--

* To contribute to other packages


---

## Who can write a package? YOU!

Susan Johnston's [very good slide](https://github.com/susjoh/fibonacci).

![](assets/susan_johnston.png)

---

## Automation!

![](assets/automate_meme.jpg )


---

## Automating... How?

Remember Clippy?

![](assets/clippy.jpg)


---


## Automating... How?

Get to know an actually useful Clippy, `usethis`!

<img src="assets/usethis_clippy.png" width="200" height="200" />



---

## `usethis` and co

<blockquote class="twitter-tweet" data-lang="ca"><p lang="en" dir="ltr">The usethis package implements this important principle: Automate that which can be automated. Your computer was literally born to implement rote-but-fussy stuff for you. <a href="https://t.co/OfIUzSBlc7">https://t.co/OfIUzSBlc7</a></p>&mdash; Jenny Bryan (@JennyBryan) <a href="https://twitter.com/JennyBryan/status/935562495816753153?ref_src=twsrc%5Etfw">28 de novembre de 2017</a></blockquote>

--

We shall use this ecosystem today:

* `RStudio`

* `devtools` and `usethis`

* `roxygen2`


---
## Today's workshop

--

* Hands-on! Is every laptop ready?

--

* These slides, hands-on, then a few slides again.

--

* Ask and help us help you!

--

* You should go home knowing the basics and how to go further.

---
## Today's package

`iemand`, create fake people.

* Inspired by [`charlatan`](https://github.com/ropensci/charlatan), "create fake data in R".

* real baby names data from Stats SA.

---

## Let's go!

<iframe src="https://giphy.com/embed/XOvKIu18WbpgQ" width="480" height="480" frameBorder="0" class="giphy-embed" allowFullScreen></iframe><p><a href="https://giphy.com/gifs/XOvKIu18WbpgQ">via GIPHY</a></p>

---

## A note on setup

Get closer to developer bliss!

http://usethis.r-lib.org/articles/articles/usethis-setup.html


---

## How to share your package?

* Binary package

* From GitHub `devtools::install_github`

* CRAN release `devtools::release`. NEWS.md + release!

---

# How to plan your R package?

---

## Should your package even exist?

* Will this piece of software really be useful to someone else than you?

--

* Is there already a package out there performing the exast same task?

--

* If there is one, would your implementation bring something to the market, e.g. an user-friendlier implementation?

--

* If there is already a similar package, should you work on your own or collaborate with the author(s) of the original package?
---

## What should your package contain exactly?

--

* Make your package compatible with the workflow of its future users.

--

* Do not get too ambitious.

--

Once it's decided:

* Sketch a to-do list,

* If working as a team like today define roles including roles for keeping contributors on track after the hackathon!

---

## What will your package be called?

A descriptive, lower-case, cool name.

--

R package `available`.

```{r, cache = TRUE, warning = FALSE, message = FALSE, results='asis'}
available::available("available")

```

---

# Bring the package to its users

François Chollet in __User experience design for APIs__, 2017-11-21.

https://blog.keras.io/user-experience-design-for-apis.html

_"In the long run, good design wins, because it makes its adepts more productive and more impactful, thus spreading faster than user-hostile undesign. Good design is infectious."_

---

## Documentation

--

Examples. Vignettes with example of a workflow.

Build a website with [`pkgdown`](http://hadley.github.io/pkgdown/).

--

## User-friendly programming

--

* __Have error and warning messages that are easy to understand__. For instance, if communicating with an API, then translate http errors.

--

* __Check the input__. For instance, If a parameter provided to a function should be a positive number, check it is and if it is not, return a friendly error message.

--

* __Offer shortcuts__. For instance, if your function relies on an API key being provided, you can silently search for it in environment variables

--

* __Choose a good naming scheme__. Prefixing all functions?

---

## Promotion

--

* How do you discover packages? Where will your target audience discover your package?
--

* Social media, specific blogs, scientific journals.
--

* If your package is an interface to an existing tool or internet resource, try to have your package listed on that tool or resource webpage.

--

## Review
--

* Anyone can review your package. 
--

* The R Journal, the Journal of Statistical Software (JSS)
--

* rOpenSci https://github.com/ropensci/onboarding/ including partnerships with:

  * Journal of Open Science Software (JOSS)
  
  * Methods in Ecology and Evolution (MEE)

--

Be a reviewer yourself!
---

## Package analytics

* `cranlogs` package

* `gh` package 

* Track uses of your package http://happygitwithr.com/search.html

---

---

## How to go further: your own package(s)?


My own blog post with many links to fantastic resources: ["How to develop good R packages"](http://www.masalmon.eu/2017/12/11/goodrpackages/)

---

## How to go further: your research compendii?

Research compendium = R package containing all the code (and data) incl. dependencies list, necessary to reproduce an article.


See [this thread for instance](https://github.com/ropensci/unconf17/issues/5).

---

## How to go further: contribute to other packages?

--

* rOpenSci onboarding (more on that tomorrow!) and [contributr Shiny app](https://github.com/LucyMcGowan/contributr).

--

*  Mara Averick's ["contributing to the tidyverse"](https://github.com/batpigandme/tverse_contributing/blob/master/tverse_contributing_rstudioconf_compressed.pdf) slides, [tidyverse contributing guide](https://www.tidyverse.org/contribute/), [Jim Hester's blog post "contributing code to the tidyverse"](http://www.jimhester.com/2017/08/08/contributing/).


---

## Last but not least, what about `iemand`?

--

*  Ask more data from Stats SA?

--

*  Andrew Collier's [`saffeR`](https://github.com/DataWookie/saffeR), an R package aggregating a selection of things relating to South Africa. 

* Julia Silge's [`southafricastats`](https://github.com/juliasilge/southafricastats), Population and Mortality Statistics for South Africa, built to support her introductory Shiny workshop at the February 2017 satRday conference.


---

## See you tomorrow! Sien jou môre! Ngizokubona kusasa! Ndiza nibona ngomso!

<iframe src="https://giphy.com/embed/l4KibK3JwaVo0CjDO" width="480" height="474" frameBorder="0" class="giphy-embed" allowFullScreen></iframe><p><a href="https://giphy.com/gifs/afv-funny-fail-lol-l4KibK3JwaVo0CjDO">via GIPHY</a></p>


